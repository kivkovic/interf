<html>
<head>

  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,400,500&amp;subset=latin-ext" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <link href="assets/prism.css" rel="stylesheet" />
  <style type="text/css">
    body {
      margin: 0;
      padding: 0;
      background: #333;
      box-sizing: border-box;
    }

    .terminal-input {
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 14px;
      color: #eee;
      border: 1px solid transparent;
      background-color: #2a2a2a;
      text-shadow: 1px 1px 0px #111;
    }

    .terminal-input:focus {
      outline: none;
    }

    .terminal-input.password {
      -webkit-text-security: disc;
      position: relative;
      top: 1px;
    }

    .terminal {
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 14px;
      color: #eee;
      background-color: #2a2a2a;
      overflow-y: scroll;
      overflow-x: auto;
      padding: 5px;
      text-shadow: 1px 1px 0px #111;
      --box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8), -1px -1px 1px -1px rgba(0,0,0,0.5);
    }

    .terminal::-webkit-scrollbar,
    #navigator::-webkit-scrollbar {
        width: 10px;
        height: 10px;
        background: #222;
    }

    .terminal::-webkit-scrollbar-thumb,
    #navigator::-webkit-scrollbar-thumb {
      background: #444;
    }

    .stderr,
    .terminal .sudo {
      color: #f87;
      font-weight: 400;
    }

    .stdout {
      color: #fefffd;
    }

    .stdout:focus {
      outline: none;
    }

    .terminal a:link, .terminal a:visited, .terminal a:active {
      color: #ded;
      text-decoration: none;
      border-bottom: 1px dashed #444;
    }

    .terminal a:link[data-isdir="true"], .terminal a:visited[data-isdir="true"], .terminal a:active[data-isdir="true"]{
      color: #eea;
    }

    #terminal-autocomplete {
      position: absolute;
      display: none;
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 14px;
      color: #eee;
      background-color: #333;
      overflow: hidden;
    }

    #navigator {
      position: relative;
      background: #2f2f2f;
      overflow-y: scroll;
      overflow-x: auto;
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 14px;
      color: #ccc;
      text-shadow: 1px 1px 0px #111;
      --box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8);
    }

    #navigator:focus {
      outline: none;
    }

    /* #navigator .file {
      display: inline-block;
      width: calc(10% - 10px);
      min-height: 100px;
      overflow-wrap: break-word;
      word-wrap: break-word;
      margin: 10px;
    } */

    #navigator .table {
      width: calc(100% - 2px);
      user-select: none;
      z-index: 190;
      position: relative;
      left: 2px;
      --box-shadow: -1px 0px 1px -1px rgba(0,0,0,0.4);
    }

    #navigator .cell {
      padding: 4px 8px;
      position: relative;
      min-width: 18px;
      vertical-align: middle;
      transition: all 0.15s ease-in-out;
    }

    #navigator .row {
      transition: all 0.15s ease-in-out;
    }

    #navigator .row:hover, #navigator .row.selected {
      background-color: #393939;
      --box-shadow: 0 1px 1px -1px rgba(0,0,0,0.4);
    }

    #navigator .row.hidden {
      color: #888;
    }

    #navigator .cell:nth-child(1) {
      width: 10px;
      text-align: center;
    }

    #navigator .cell:nth-child(3) {
      font-size: 11px;
      width: 120px;
      overflow: hidden;
    }

    #navigator .cell:nth-child(4) {
      font-size: 10px;
      width: 90px;
      overflow: hidden;
    }

    #navigator .cell:nth-child(5) {
      font-size: 11px;
      overflow: hidden;
      width: 110px;
    }

    #navigator .cell time {
      font-size: 10px;
    }

    #navigator .cell i {
      font-size: 18px;
    }

    #navigator .navlocation {
      position: sticky;
      left: 0;
      top: 0;
      width: calc(100% - 327px);
      background: #2b2b2b;
      border: none;
      color: #aaa;
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 14px;
      padding: 4px;
      z-index: 210;
      --box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8);
    }

    #navigator .navlocation:focus {
      outline: none;
    }

    #navigator .controls {
      width: 325px;
      padding-left: 2px;
      position: sticky;
      float: right;
      top: 0;
      right: 0;
      z-index: 205;
      background: #333;
    }

    #navigator .controls .control {
      width: 26px;
      height: 24px;
      display: inline-block;
      text-align: center;
      margin: 0 5px;
      background: #333;
      cursor: pointer;
      z-index: 250;
      --box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8);
    }

    #navigator .controls .control:hover {
      color: #fff;
    }

    #navigator .controls .control i {
      font-size: 18px;
      line-height: 24px;
    }

    #navigator .controls .control .fa-chevron-up {
      top: 1px;
    }

    #navigator .separator {
      width: 100%;
      height: 4px;
      position: sticky;
      top: 24px;
      background: #333;
      z-index: 200;
      --box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8);
    }

    .thumbnail {
      width: 18px;
      height: 18px;
      position: relative;
      top: 1px;
      margin: -4px 0;
      overflow: hidden;
      display: inline-block;
    }

    .thumbnail img {
      height: 18px;
    }

    .row:hover .thumbnail {
      overflow: visible;
      top: 2px;
      left: 7px;
      position: absolute;
      z-index: 100;
    }

    .row:hover .thumbnail img {
      width: 200px;
      height: auto;
    }

    .row:hover .cell:nth-child(2) {
      z-index: 100;
      color: #fff;
    }

    .table {
      display: table;
    }

    .row {
      display: table-row;
    }

    .cell {
      display: table-cell;
    }

    img[data-loaded="false"] {
      opacity: 0;
    }

    .fa-folder          { color: #fda; }
    .fa-file-audio      { color: #eee; }
    .fa-file-pdf        { color: #eee; }
    .fa-file-word       { color: #eee; }
    .fa-file-excel      { color: #eee; }
    .fa-file-powerpoint { color: #eee; }
    .fa-file-archive    { color: #eee; }
    .fa-file-code       { color: #eee; }
    .fa-file-alt        { color: #eee; }

    .row:hover .fa-folder          { color: #feb; }
    .row:hover .fa-file-audio      { color: #fff; }
    .row:hover .fa-file-pdf        { color: #fff; }
    .row:hover .fa-file-word       { color: #fff; }
    .row:hover .fa-file-excel      { color: #fff; }
    .row:hover .fa-file-powerpoint { color: #fff; }
    .row:hover .fa-file-archive    { color: #fff; }
    .row:hover .fa-file-code       { color: #fff; }
    .row:hover .fa-file-alt        { color: #fff; }

    #contextmenu {
      position: absolute;
      top: 10px;
      left: 10px;
      list-style: none;
      margin: 0;
      padding: 0;
      background: #333;
      min-width: 160px;
      z-index: 4000;
      transition: height 0.07s ease-out;
      overflow: hidden;
      font-family: 'Roboto Mono', monospace;
      font-weight: 300;
      font-size: 12px;
      color: #ccc;
      text-shadow: 1px 1px 0px #111;
      box-shadow: 1px 1px 1px -1px rgba(0,0,0,0.8), -1px -1px 1px -1px rgba(0,0,0,0.4);
      /* */
      height: 0;
    }

    #contextmenu li {
      padding: 4px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    #contextmenu li:hover {
      background-color: #393939;
      --box-shadow: 0 1px 1px -1px rgba(0,0,0,0.4);
    }

    #contextmenu li i {
      width: 32px;
      text-align: center;
      margin-right: 7px;
      font-size: 16px;
    }

    #contextmenu li svg {
      width: 24px;
      height: 24px;
      fill: #ddd;
      position: relative;
      top: 2px;
      left: 4px;
      margin: -4px 16px -4px 0;
    }

    #contextmenu li.separator, #contextmenu li.separator:hover {
      background-color: #333;
      box-shadow: none;
    }

    #apps .icon {
      display: inline-block;
      width: 64px;
      height: 64px; /* */
      margin: 10px 0 10px 10px;
      transform: perspective(1px) translateZ(0);
    }

    #apps .icon.menu {
      color: #fff;
      font-size: 36px;
      text-align: center;
      width: 64px;
      height: 64px;
      transition: transform 0.2s ease-in-out;
    }

    #apps .icon.menu i {
      position: relative;
      position: relative;
      top: -18px;
      left: 0;
      text-shadow: 1px 1px 2px #000;
    }

    #apps .icon:not(.menu):hover {
      filter: brightness(120%);
      transition: all 0.07s ease-out;
      /* animation-name: blurinout;
      animation-duration: 0.07s;
      animation-timing-function: ease-in-out;
      animation-iteration-count: 1; */
    }

    /* #apps:hover .icon:not(:hover):not(.menu) {
      transform: scale(0.6);
    } */

    #apps .icon:hover:not(.menu) {
      transform: scale(1.20);
    }

    #apps .icon.menu:hover {
      color: #ddd;
    }

    #apps .icon > svg {
      width: 100%;
      height: 100%;
    }

    @keyframes hvr-buzz-out {
      0% { transform: translateX(0) rotate(1deg); }
      33% { transform: translateX(-1px) rotate(-1deg); }
      66% { transform: translateX(1px) rotate(0); }
      100% { transform: translateX(0) rotate(0); }
    }

    @keyframes blurinout {
      0% { filter: blur(0); }
      50% { filter: blur(5px); }
      100% { filter: blur(0); }
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>

  <script type="text/javascript">

  let user = {};

  const server = 'http://192.168.5.14:1337/';

  function initConsole(terminal, autocomplete) {
    terminal.classList.add('terminal');

    const location = document.createElement('span');
    //terminal.appendChild(location);
    let locationText = '';

    const input = document.createElement('input');
    input.className = 'input';
    input.className = 'terminal-input';
    input.value = '';
    input.style.display = 'none';
    terminal.appendChild(input);
    input.focus();

    let start = terminal.selectionStart;
    let disabled = false;
    let historycounter = 0;
    let currentPwd = '~';
    let waitingForCommand = false;
    let waitingForPassword = false;
    let waitingForCtrlEvent = false;
    let possiblyInteractive = false;
    let waitingForAutocomplete = false;
    let command = null;
    let lastResponse = null;
    let lineBuffer = [];
    const executedlines = [];
    const socket = io(server);

    socket.on('connected', data => {
      console.log('connected to socket.io on ' + server);
      waitingForCommand = true;
      setTimeout(() => socket.emit('bash', 'hello\n'), 500);
    });

    socket.on('console.out', data => {

      clearTimeout(lastResponse);
      lastResponse = setTimeout(() => {
        console.log('data from server', lineBuffer);

        if (waitingForAutocomplete || waitingForCtrlEvent) {

          let lines = [];
          autocomplete.innerHTML = '';

          if (waitingForAutocomplete) {
            lines = lineBuffer[1].split(/\s+/)
              .filter(line => line)
              .filter((line, i, lines) => {
                if (!i) {
                  return !line.match(/^\x1B]0;.+:$/);
                }
                if (lines.length == 2 && i == 1) {
                  return !line.match(/~\x07\x1B\[.+\[00m[#$]$/);
                }
                return line;
            });

          } else if (waitingForCtrlEvent) {
            if (lineBuffer.join('').match(/\(reverse-i-search\)/)) {
              lineBuffer = [];
              return;
            }
            lines = lineBuffer.map(line => line.replace(/^.+?':\s*/, '').replace(/\x1b\[C\x1B\[.*$/, ''));
          }

          waitingForAutocomplete = false;

          if (lines.length) {
            lines.map(entry => {
              const option = document.createElement('option');
              option.value = option.innerText = entry;
              autocomplete.appendChild(option);
            });

            autocomplete.size = Math.min(8, lines.length);
            autocomplete.style.display = 'block';
            autocomplete.style.top = (input.offsetTop + input.offsetHeight + 2) + 'px';
            autocomplete.style.left = input.offsetLeft + 'px';
            autocomplete.selectedIndex = 0;
            autocomplete.focus();
          }

        } else {

          if (!lineBuffer.length) {
            debugger; // should be unreachable

          } else if ((lineBuffer[0] + lineBuffer[1]).match(/(\[sudo\] password for|Sorry, try again)/i)) {
            waitingForPassword = true;
            createNewLine('password');

          } else {
            possiblyInteractive = false;

            const response = lineBuffer
              .join('\r\n').split('\r\n') // realigns line endings, because the way bash output is chunked is random
              .filter((line, i, lines) => {
                if (line.match(/(\?1h\x1B|\x1B\[\?1h)/)) {
                  possiblyInteractive = true;
                  return false;
                }
                if (i == lines.length - 1) {
                  locationText = bashColors(line.replace(/^.+?\x07/, ''));
                }
                // 1) skip empty lines and \uffe3 (response from ctrl commands)
                // 2) if a command was pushed, it's echoed back in the first line of the response, so skip it (could be used to replace current input)
                // 3) last line is input line prefix
                return line.length && line != '\uffe3' && (i != 0 || !waitingForCommand) && i != lines.length - 1;
              });

            appendResponse(response.join('\n'));
          }

          waitingForCommand = false;
        }

        lineBuffer = [];
        disabled = false;
      }, 600);

      lineBuffer.push(data);
    });

    function createNewLine(type = 'normal') {
      terminal.appendChild(document.createElement('br'));
      const clone = location.cloneNode(true);

      if (type != 'password') {
        clone.innerHTML = locationText;
        input.classList.remove('password');

      } else {
        const last = getLastChild(terminal);
        const parent = last.parentNode;
        parent.replaceChild(document.createTextNode(input.value), last);
        parent.appendChild(last);
        clone.innerHTML = `<span class="sudo">Password:</span>&nbsp;`;
        waitingForPassword = true;
        input.value = '';
        input.classList.add('password');
      }

      terminal.appendChild(clone);
      terminal.appendChild(input);
      //debugger;
      input.style.width = `calc(100% - ${clone.innerText.length * 9.4 + 10}px)`;
      input.style.display = '';
      input.focus();
      terminal.scrollTop = terminal.scrollHeight;
    }

    function appendResponse(string) {
      const clone = input.cloneNode(true);
      clone.readOnly = 'readonly';
      terminal.replaceChild(clone, input);
      input.value = '';

      const response = document.createElement('div');
      response.style.cssText = 'white-space: pre;';
      response.className = 'stdout';
      response.tabIndex = '0';
      response.innerHTML = bashColors(string);
      terminal.appendChild(response);

      createNewLine();
    }

    function executeInput() {
      executedlines.push(input.value);
      historycounter = executedlines.length;

      const command = input.value + (possiblyInteractive ? '' : '\n');
      console.log('sending command', command);
      socket.emit('bash', command);

      disabled = true;
      waitingForCommand = true;
      waitingForPassword = false;
    }

    terminal.onfocus = function () {
      input.focus();
    }

    terminal.onkeydown = function (event) {

      if (event.ctrlKey && event.key != 'Control') { // ctrl + letter combos
        event.stopPropagation();
        event.preventDefault();

        socket.emit('bash', String.fromCharCode(event.key.charCodeAt(0) - 96));
        if (event.key == 'c') {
          waitingForCtrlEvent = false;
        } else if (event.key == 'r') {
          waitingForCtrlEvent = true;
          input.onkeydown = event => {
            if (event.key == 'Enter') debugger;
            const key = event.key.length == 1 ? event.key : String.fromCharCode(event.keyCode);
            socket.emit('bash', key);
          }
        }

        return false;
      }

      if (disabled) {
        event.preventDefault();
        return false;
      }

      const text = input.value.replace(/\u00a0/g, ' ');

      if (event.key == 'Enter') {
        if (text.length) {
          executeInput();
        } else {
          createNewLine();
        }
        event.preventDefault();
        return false;

      } else if (event.key == 'ArrowUp') {

        if (executedlines.length) {
          historycounter = historycounter > 0 ? --historycounter : executedlines.length - 1;
          input.value = executedlines[historycounter];
          input.focus();
        }
        event.preventDefault();
        return false;

      } else if (event.key == 'ArrowDown') {
        if (executedlines.length) {
          historycounter = (historycounter + 1) % executedlines.length;
          input.value = executedlines[historycounter];
          input.focus();
        }
        event.preventDefault();
        return false;

      } else if (event.key == 'Tab') {
        waitingForAutocomplete = true;
        socket.emit('bash', `echo ${text.trim()}$'\\t'$'\\t' | bash -i 2>&1 | head -n -4 | tail -n +2\n`);
        event.preventDefault();
        return false;

      }
    }

    autocomplete.onkeydown = event => {
      if (event.key == 'Enter' || event.key == ' ' || event.key == 'Escape' || event.key == 'Tab' || event.key == 'Backspace') {
        if (event.key == 'Backspace') {
          input.value = input.value.slice(0, -1);
        } else if (event.key != 'Escape') {
          if (input.value.match(/(\u00a0| )$/)) {
            input.value += autocomplete.value;
          } else {
            input.value = autocomplete.value;
          }
        }

        autocomplete.style.display = 'none';
        input.focus();
        event.preventDefault();
        return false;
      }
    };

  }

  function handleFileOpen(file, type) {

    const display = document.querySelector('#display'); // TODO extract
    const editor = document.querySelector('#text-editor'); // TODO extract
    display.parentNode.style.display = 'none';
    editor.style.display = 'none';

    const embed = document.createElement('embed');
    embed.type = type;
    embed.src = 'http://192.168.5.14:1337/' + file;

    if (type.match(/^text/)) {
      embed.style.minWidth = '100%';
      embed.style.minHeight = '50vh';
      editor.innerHTML = '';
      editor.appendChild(embed);
      editor.style.display = 'block';

    } else {

      if (type.match(/^video/)) {
        embed.style.width = '100%';
        embed.style.height = '100%';
      } else {
        embed.style.minWidth = '100%';
        embed.style.minHeight = '50vh';
      }

      display.innerHTML = '';
      display.appendChild(embed);
      display.parentNode.style.display = 'block';
    }
  }

  function getLastChild(element) {
    let lastChild = element.lastChild;
    while (lastChild && lastChild.nodeType != 1) {
      if (lastChild.previousSibling) {
        lastChild = lastChild.previousSibling;
      } else {
        break;
      }
    }
    return lastChild;
  }

  function canContainText(node) {
    if (node.nodeType == 1) {
      return !['BR', 'IMG', 'INPUT', 'LABEL', 'DIV', 'SPAN', 'STRONG'].indexOf(node.nodeName) != -1;
    }
    return false;
  }

  function bashColors(string) {
    return (string
      .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;') // html escape
      .replace(/\x1B\[([0-9;]+|J|K|#)?m?/g, (matches, font) => {
        if (!font || font == '0') return '</span>';
        if (font.match(/[JK#]/)) return '<br/>';

        let style = '';
        if (font.match(/\b0?0?1\b/)) style += 'font-weight: 500;';
        if (font.match(/\b0?30\b/)) style += 'color: black;';
        if (font.match(/\b0?31\b/)) style += 'color: crimson;';
        if (font.match(/\b0?32\b/)) style += 'color: green;';
        if (font.match(/\b0?33\b/)) style += 'color: gold;';
        if (font.match(/\b0?34\b/)) style += 'color: cornflowerblue;';
        if (font.match(/\b0?35\b/)) style += 'color: mediumorchid;';
        if (font.match(/\b0?36\b/)) style += 'color: darkcyan;';
        if (font.match(/\b0?37\b/)) style += 'color: lightgray;';
        if (font.match(/\b0?90\b/)) style += 'color: darkgray;';
        if (font.match(/\b0?91\b/)) style += 'color: red;';
        if (font.match(/\b0?92\b/)) style += 'color: lime;';
        if (font.match(/\b0?93\b/)) style += 'color: yellow;';
        if (font.match(/\b0?94\b/)) style += 'color: deepskyblue;';
        if (font.match(/\b0?95\b/)) style += 'color: magenta;';
        if (font.match(/\b0?96\b/)) style += 'color: cyan;';
        if (font.match(/\b0?97\b/)) style += 'color: white;';
        if (font.match(/\b0?40\b/)) style += 'background: black;';
        if (font.match(/\b0?41\b/)) style += 'background: crimson;';
        if (font.match(/\b0?42\b/)) style += 'background: green;';
        if (font.match(/\b0?43\b/)) style += 'background: gold;';
        if (font.match(/\b0?44\b/)) style += 'background: cornflowerblue;';
        if (font.match(/\b0?45\b/)) style += 'background: mediumorchid;';
        if (font.match(/\b0?46\b/)) style += 'background: darkcyan;';
        if (font.match(/\b0?47\b/)) style += 'background: lightgray;';
        if (font.match(/\b100\b/)) style += 'background: darkgray;';
        if (font.match(/\b101\b/)) style += 'background: red;';
        if (font.match(/\b102\b/)) style += 'background: lime;';
        if (font.match(/\b103\b/)) style += 'background: yellow;';
        if (font.match(/\b104\b/)) style += 'background: deepskyblue;';
        if (font.match(/\b105\b/)) style += 'background: magenta;';
        if (font.match(/\b106\b/)) style += 'background: cyan;';
        if (font.match(/\b107\b/)) style += 'background: white;';

        return `<span style="${style}">`;
      }))
      //.replace(/^\x1B\d{0,2}\??\d{0,2}h/)
      //.replace(/^(\?\d{1,2}h)+/g)
      .replace(/\x1B\[?./g, '') // replace remaining bash escape sequences
  }

  function initNavigator(filenavigator, contextmenu) {

    loadPath('');

    function createCell(contents, className = '') {
      const cell = document.createElement('div');
      cell.className = 'cell ' + className;
      typeof contents == 'string' && (cell.innerHTML = contents);
      typeof contents == 'object' && (cell.appendChild(contents));
      return cell;
    }

    function createControl(title, icon, onclick, css) {
      const control = document.createElement('div');
      control.title = title;
      control.className = 'control';
      control.innerHTML = `<i class="${icon}" style="${css}"></i>`;
      control.onclick = onclick;
      return control;
    }

    function createContextControl(text, icon, onclick, css, raw = null) {
      if (text == false) {
        const separator = document.createElement('li');
        separator.className = 'separator';
        return separator;
      }
      const control = document.createElement('li');
      control.innerHTML = raw != null ? raw : `<i class="${icon}" style="${css}"></i>${text.replace(/^./, m => m.toUpperCase())}`;
      control.onclick = onclick;
      return control;
    }

    function loadPath(path) {
      fetch(server + 'files/?path=' + (path || ''))
      .then(data => data.json())
      .then(data => {
        if (!data.out || !data.out.path) {
          return;
        }

        filenavigator.style.display = 'block';
        filenavigator.innerHTML = '';

        const navlocation = document.createElement('input');
        navlocation.className = 'navlocation';
        navlocation.value = data.out.path;
        navlocation.onkeydown = event => event.key == 'Enter' ? loadPath(navlocation.value) : true;
        filenavigator.appendChild(navlocation);

        const table = document.createElement('div');
        table.className = 'table';

        const rows = [];

        let dragging = false, selection = [], copyClipboard = [], cutClipboard = [], holdingCtrl = false;
        filenavigator.onmousedown = (event) => {
          return (
            holdingCtrl ||
            event.target.classList.contains('control') ||
            event.target.parentNode.classList.contains('control') ||
            (dragging = true, selection = [], rows.map(r => r.classList.remove('selected')))
          );
        };
        filenavigator.onmouseup = () => dragging = false;
        filenavigator.onkeydown = event => (event.ctrlKey && (holdingCtrl = true), true);
        filenavigator.onkeyup = event => (holdingCtrl = false, true);

        const parent = data.out.path.split('/').slice(0, -1).join('/');
        if (parent) {
          const row = document.createElement('div');
          row.className = 'row';
          const uplink = document.createElement('span');
          uplink.innerText = '..';
          uplink.style.cursor = 'pointer';
          uplink.onclick = () => loadPath(parent);
          row.appendChild(createCell(createIcon({ mime: 'inode/directory' })));
          row.appendChild(createCell(uplink, 'file'));
          row.appendChild(createCell('Folder'));
          row.appendChild(createCell(''));
          row.appendChild(createCell(''));
          table.appendChild(row);
        }

        const navup = () => loadPath(parent);
        const home = () => loadPath('');
        const cut = () => (cutClipboard = cutClipboard.concat(selection), copyClipboard = [], selection = []);
        const copy = () => (copyClipboard = copyClipboard.concat(selection), cutClipboard = [], selection = []);
        const paste = () => console.log('RENAME', selection);
        const rename = () => console.log('DELETE', selection);
        const del = () => console.log('ARCHIVE', selection);
        const archive = () => console.log('SHARE', selection);
        const share = () => console.log('TERMINAL HERE', selection);
        const terminalhere = () => {
          if (copyClipboard.length) console.log('copy-pasting', copyClipboard);
          if (cutClipboard.length) console.log('cut-pasting', cutClipboard);
          copyClipboard = [];
          cutClipboard = [];
          rows.map(r => r.classList.remove('selected'));
        };
        const focusSearchInput = () => console.log('focusSearchInput');
        const newfolder = () => console.log('newfolder');
        const newfile  = () => console.log('newfile ');

        const controls = document.createElement('div');
        controls.className = 'controls';

        contextmenu.innerHTML = '';
        contextmenu.className = 'contextmenu';

        table.onclick = (e) => contextmenu.style.height = '0';

        contextmenu.append(createContextControl('search', 'fas fa-search', focusSearchInput));
        contextmenu.append(createContextControl(false));
        contextmenu.append(createContextControl('new folder', 'fas fa-folder-plus', newfolder));
        contextmenu.append(createContextControl('new file', 'fas fa-file-medical', newfile));
        contextmenu.append(createContextControl(false));

        for (let def of [{ ref: controls, fn: createControl }, { ref: contextmenu, fn: createContextControl }]) {
          def.ref.append(def.fn('navigate up', 'fas fa-chevron-up', navup));
          def.ref.append(def.fn('home', 'fas fa-home', home));
          def.ref.append(def.fn('terminal here', 'fas fa-terminal', terminalhere, 'font-size: 16px; line-height: 19px;'));
          if (def.ref == contextmenu) contextmenu.append(createContextControl(false));
          def.ref.append(def.fn('cut', 'fas fa-cut', cut));
          def.ref.append(def.fn('copy', 'fas fa-copy', copy));
          def.ref.append(def.fn('paste', 'fas fa-paste', paste));
          def.ref.append(def.fn('delete', 'fas fa-trash', del));
          if (def.ref == contextmenu) contextmenu.append(createContextControl(false));
          def.ref.append(def.fn('rename', 'fas fa-i-cursor', rename));
          if (def.ref == contextmenu) def.ref.append(def.fn('archive', '', archive, null, '<svg><use xlink:href="#archive" /></svg>Archive'));
          if (def.ref == contextmenu) def.ref.append(def.fn('unarchive', '', archive, null, '<svg><use xlink:href="#unarchive" /></svg>Unarchive'));
          def.ref.append(def.fn('share', 'fas fa-share-alt', share));
        }

        filenavigator.append(controls);

        data.out.files
        .sort((a, b) => {
          if (a.mime.match(/directory/) && !b.mime.match(/directory/)) return -1;
          return a.filename > b.filename ? 1 : a.filename < b.filename ? -1 : 0;
        })
        .map(file => {
          const row = document.createElement('div');
          row.className = 'row';
          const filelink = document.createElement('span');
          filelink.innerHTML = file.filename;
          filelink.style.cursor = 'pointer';
          if (file.mime.match(/directory/)) {
            filelink.onclick = () => loadPath(file.fullpath);
          } else {
            filelink.onclick = () => console.log('TODO open file');
          }

          let contextMenuOpen = false;

          row.onmousemove = () => holdingCtrl || !dragging || selection.indexOf(file) != -1 || (selection.push(file), row.classList.add('selected'));
          row.onclick = event => {
            if (holdingCtrl) {
              selection.push(file);
              row.classList.add('selected');
            } else if (holdingCtrl) {
              return false;
            } else {
              selection = [file];
              rows.map(r => r == row ? r.classList.add('selected') : r.classList.remove('selected'));
            }
            /* event.preventDefault();
            event.stopPropagation();
            return false; */
          }

          const filename = createCell(filelink, 'file');
          if (file.filename.match(/^\./)) {
            row.classList.add('hidden');
          }

          row.addEventListener('contextmenu', function(event) {
            contextMenuOpen = true;
            contextmenu.style.left = `${event.clientX}px`;
            contextmenu.style.top = `${event.clientY}px`;
            contextmenu.style;
            contextmenu.style.height = Array.from(contextmenu.children).reduce((a,c) => c.offsetHeight + a, 0) - 1 + 'px';
            event.stopPropagation();
            event.preventDefault();
            return false;
          }, false);

          row.appendChild(createCell(createIcon(file)));
          row.appendChild(filename);
          row.appendChild(createCell(formatMime(file.mime)));
          row.appendChild(createCell(!file.mime.match(/directory/) && file.stats && file.stats.size != null ? formatSize(file.stats.size) : ''));
          row.appendChild(createCell(formatTimeStr(file.stats.mtime)));
          table.appendChild(row);
          rows.push(row);
        });

        const separator = document.createElement('div');
        separator.className = 'separator';
        filenavigator.appendChild(separator);

        filenavigator.appendChild(table);

        let iteration = 0;
        const refreshImages = () => {
          iteration++;
          const images = Array.from(document.querySelectorAll('img[data-loaded="false"]'));
          images.map(img => {
            if (img.naturalWidth === 0) {
              img.src = img.src.replace(/\?\d+$/, '') + '?' + (+new Date());
            } else {
              img.dataset.loaded = 'true';
            }
          });
          if (!images.length || iteration > 20) clearInterval(refreshInterval);
        };

        refreshImages();
        var refreshInterval = setInterval(refreshImages, 1000);
      });
    }
  }

  function formatMime(mime) {
    return ({
      'application/epub+zip': 'EPUB',
      'application/java-archive': 'Java Archive',
      'application/json': 'JSON',
      'application/ld+json': 'JSON-LD',
      'application/msword': 'Microsoft Word',
      'application/octet-stream': 'Binary file',
      'application/ogg': 'OGG audio',
      'application/pdf': 'PDF',
      'application/rtf': 'Rich Text Format',
      'application/vnd.amazon.ebook': 'Amazon Kindle eBook',
      'application/vnd.apple.installer+xml': 'Apple Installer Package',
      'application/vnd.mozilla.xul+xml': 'XUL',
      'application/vnd.ms-excel': 'Microsoft Excel',
      'application/vnd.ms-fontobject': 'MS Embedded OpenType font',
      'application/vnd.ms-powerpoint': 'Microsoft PowerPoint',
      'application/vnd.oasis.opendocument.presentation': 'OpenDocument presentation',
      'application/vnd.oasis.opendocument.spreadsheet': 'OpenDocument spreadsheet',
      'application/vnd.oasis.opendocument.text': 'OpenDocument text document',
      'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'Microsoft PowerPoint',
      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'Microsoft Excel',
      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'Microsoft Word',
      'application/vnd.visio': 'Microsoft Visio',
      'application/x-7z-compressed': '7-zip archive',
      'application/x-abiword': 'AbiWord document',
      'application/x-bzip': 'BZip archive',
      'application/x-bzip2': 'BZip2 archive',
      'application/x-csh': 'C-Shell script',
      'application/x-freearc': 'Archive document',
      'application/x-rar-compressed': 'RAR archive',
      'application/x-sh': 'Bourne script',
      'application/x-shockwave-flash': 'Shockwave Flash',
      'application/x-tar': 'TAR archive',
      'application/xhtml+xml': 'XHTML',
      'application/xml': 'XML',
      'application/zip': 'ZIP archive',
      'audio/aac': 'AAC audio',
      'audio/midi': 'MIDI audio',
      'audio/x-midi': 'MIDI audio',
      'audio/mpeg': 'MP3 audio',
      'audio/ogg': 'OGG audio',
      'audio/wav': 'WAV audio',
      'audio/webm': 'WEBM audio',
      'font/otf': 'OpenType font',
      'font/ttf': 'TrueType Font',
      'font/woff': 'WOFF font',
      'font/woff2': 'WOFF font',
      'image/bmp': 'BMP image',
      'image/gif': 'GIF image',
      'image/jpeg': 'JPEG image',
      'image/png': 'PNG image',
      'image/svg+xml': 'SVG vector',
      'image/tiff': 'TIFF',
      'image/vnd.microsoft.icon': 'Icon',
      'image/webp': 'WEBP image',
      'inode/directory': 'Folder',
      'text/calendar': 'iCalendar',
      'text/css': 'CSS',
      'text/csv': 'CSV',
      'text/html': 'HTML',
      'text/javascript': 'Javascript',
      'text/plain': 'Text',
      'video/3gpp': '3GPP video',
      'video/mpeg': 'MPEG video',
      'video/ogg': 'OGG video',
      'video/webm': 'WEBM video',
      'video/x-msvideo': 'AVI video',
      'video/mp4': 'MP4 video',
    })[mime];
  }

  function createIcon(file) {
    if (file.thumbnail) return `<div class="thumbnail"><img src="http://192.168.5.14:1337/${file.thumbnail}" data-loaded="false" /></div>`;
    if (file.mime.match(/directory$/)) return '<i class="fas fa-folder"></i>'
    if (file.mime.match(/^audio/)) return '<i class="fas fa-file-audio"></i>';
    if (file.mime.match(/pdf$/)) return '<i class="fas fa-file-pdf"></i>';
    if (file.mime.match(/vnd.+presentation/)) return '<i class="fas fa-file-word"></i>';
    if (file.mime.match(/vnd.+sheet/)) return '<i class="fas fa-file-excel"></i>';
    if (file.mime.match(/vnd.+(text|document)/)) return '<i class="fas fa-file-powerpoint"></i>';
    if (file.mime.match(/application\/.*(zip|7z|tar|bz|bzip|gz|gzip)/)) return '<i class="fas fa-file-archive"></i>';
    if (file.mime.match(/^text/)) {
      if (file.filename.match(/\.(jsx?|json|tsx?|py|php|cc?|cpp|java|sh)$/)) return '<i class="fas fa-file-code"></i>';
      return '<i class="fas fa-file-alt"></i>';
    }

    return '<i class="fas fa-file"></i>';
  }

  function formatSize(size) {
    if (size < 1024) return Math.round(size / 1024 * 10) / 10 + 'kB';
    if (size < 1024 * 1024) return Math.round(size / 1024) + 'kB';
    if (size < 1024 * 1024 * 1024) return Math.round(size / 1024 / 1024 * 10) / 10 + 'MB';
    return Math.round(size / 1024 / 1024 / 1024 * 100) / 100 + 'GB';
  }

  function formatTimeStr(time) {
    return time.replace(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}).+$/, '<date>$1-$2-$3</date> <time>$4:$5</time>');
  }

  function initApps(approw) {
    //
    const apps = [
      { special: 'menu' },
      { name: 'chrome' },
      { name: 'mail' },
      { name: 'music' },
      { name: 'drive' },
      { name: 'photos' },
      { name: 'sublime' },
      { name: 'docs' },
      { name: 'sheets' },
      { name: 'calendar' },
    ];

    approw.style.maxWidth = (apps.length * 150) + 'px';

    apps.map(app => {
      const icon = document.createElement('div');
      icon.className = 'icon';

      if (app.special == 'menu') {
        icon.className += ' menu';
        icon.innerHTML = '<i class="fas fa-bars"></i>';
      } else {
        icon.style.width = `calc(${100 / (apps.length)}% - 15px)`;
        icon.innerHTML = `<svg><use xlink:href="#${app.name}" /></svg>`;
      }
      approw.appendChild(icon);
    });
  }

  window.addEventListener('DOMContentLoaded', (event) => {
    initConsole(document.getElementById('terminal'), document.getElementById('terminal-autocomplete'));
    initNavigator(document.getElementById('navigator'), document.getElementById('contextmenu'));
    initApps(document.getElementById('apps'));
  });
  </script>
</head>
<body>
  <div id="apps" style="width: calc(100% - 20px); height: 80px;"></div>
  <div id="navigator" tabIndex="10" style="display: none; width: calc(100% - 20px); height: calc(50vh - 25px); max-height: calc(50vh - 25px); margin: 10px;"></div>
  <ul id="contextmenu"></ul>
  <div id="terminal" tabindex="0" style="width: calc(100% - 30px); height: calc(50vh - 95px); max-height: calc(50vh - 95px); margin: 10px;">
  </div>
  <select multiple id="terminal-autocomplete"></select>
  <div style="display: none; width: calc(100% - 20px); height: calc(50vh - 25px); max-height: calc(50vh - 25px); margin: 10px; overflow-x: hidden; overflow-y: scroll;">
    <div id="display" style="width: 100%;"></div>
  </div>
  <div id="text-editor" style="display: none; width: calc(100% - 20px); height: calc(50vh - 25px); max-height: calc(50vh - 25px); margin: 10px;"></div>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
<symbol id="mail" width="64" height="64" version="1.1" viewBox="0 0 16.933333 16.933333"><g transform="translate(0 -280.07)"><path d="m2.3813 284.83h12.171c0.43974 0 0.79376 0.35402 0.79376 0.79376v8.4666c0 0.43974-0.35402 0.79376-0.79376 0.79376h-12.171c-0.43974 0-0.79376-0.35402-0.79376-0.79376v-8.4666c0-0.43974 0.35402-0.79376 0.79376-0.79376z" fill="#9f3129" style="paint-order:markers stroke fill"/><rect x="2.6458" y="282.18" width="11.642" height="8.9958" ry=".79376" fill="#fff" stroke="#000" stroke-opacity=".058824" stroke-width=".26458" style="paint-order:markers stroke fill"/><path d="m15.181 285.14c0.10189 0.13347 0.16485 0.29844 0.16485 0.48007v8.4667c0 0.43974-0.35401 0.79375-0.79375 0.79375h-12.171c-0.20513 0-0.38961-0.0794-0.5302-0.20619z" fill="#f4685c" style="paint-order:markers stroke fill"/><path d="m1.7523 285.14c-0.10189 0.13347-0.16485 0.29844-0.16485 0.48007v8.4667c0 0.43974 0.35401 0.79375 0.79375 0.79375h12.171c0.20513 0 0.38961-0.0794 0.5302-0.20619z" fill="#ff7a6e" style="paint-order:markers stroke fill"/></g></symbol>
<symbol id="docs" viewBox="0 0 512 512"><path style="fill:#518EF8;" d="M441.412,140.235v338.781c0,18.219-14.778,32.983-32.983,32.983H103.572 c-18.219,0-32.983-14.764-32.983-32.983V32.983C70.588,14.764,85.352,0,103.572,0h197.605L441.412,140.235z"/><g> <rect x="161.18" y="257.054" style="fill:#FFFFFF;" width="189.626" height="21.071"/> <rect x="161.18" y="304.112" style="fill:#FFFFFF;" width="189.626" height="21.071"/> <rect x="161.18" y="351.171" style="fill:#FFFFFF;" width="189.626" height="21.071"/> <rect x="161.18" y="398.23" style="fill:#FFFFFF;" width="134.855" height="21.071"/> </g><polygon style="fill:#3A5BBC;" points="320.31,137.188 441.412,187.079 441.412,140.235 372.751,119.962 "/><path style="fill:#ACD1FC;" d="M441.412,140.235H334.16c-18.22,0-32.983-14.764-32.983-32.983V0L441.412,140.235z"/></symbol>
<symbol id="calendar" viewBox="0 0 511.999 511.999"><path style="fill:#E6E6E6;" d="M455.617,10.846H56.367c-12.437,0-22.517,10.094-22.517,22.531v74.912h444.296V33.377 C478.147,20.939,468.053,10.846,455.617,10.846z M148.16,55.922c-5.953,0-10.784-4.831-10.784-10.784s4.831-10.784,10.784-10.784 c5.953,0,10.784,4.831,10.784,10.784S154.112,55.922,148.16,55.922z M366.656,55.922c-5.953,0-10.784-4.831-10.784-10.784 s4.831-10.784,10.784-10.784s10.784,4.831,10.784,10.784S372.608,55.922,366.656,55.922z"/><path style="fill:#3A5BBC;" d="M511.505,113.523l-34.077,177.704l13.918,184.793c1.021,13.559-9.706,25.134-23.322,25.134H43.96 c-13.602,0-24.343-11.575-23.322-25.134l13.933-184.793L0.494,113.523C-2.712,96.815,10.099,81.3,27.123,81.3h457.74 C501.901,81.3,514.711,96.815,511.505,113.523z"/><path style="fill:#518EF8;" d="M468.024,501.153H43.96c-13.602,0-24.343-11.575-23.322-25.134l13.933-184.793h244.435h198.423 l13.918,184.793C492.368,489.578,481.641,501.153,468.024,501.153z"/><g> <path style="fill:#FFFFFF;" d="M247.371,244.856c0-34.687-29.026-62.906-64.703-62.906s-64.703,28.219-64.703,62.906h21.568 c0-22.794,19.351-41.338,43.136-41.338s43.136,18.544,43.136,41.338s-19.351,41.338-43.136,41.338h-20.13v21.568h20.13 c23.785,0,43.136,18.544,43.136,41.338c0,22.794-19.351,41.338-43.136,41.338s-43.136-18.544-43.136-41.338h-21.568 c0,34.687,29.026,62.906,64.703,62.906s64.703-28.219,64.703-62.906c0-21.663-11.322-40.802-28.513-52.122 C236.05,285.659,247.371,266.519,247.371,244.856z"/> <polygon style="fill:#FFFFFF;" points="289.289,218.704 300.353,237.218 342.989,211.741 342.989,401.222 364.556,401.222 364.556,173.728 "/> </g></symbol>
<symbol id="sheets" viewBox="0 0 512 512"><path style="fill:#28B446;" d="M441.412,140.235v338.781c0,18.219-14.778,32.983-32.983,32.983H103.572 c-18.219,0-32.983-14.764-32.983-32.983V32.983C70.588,14.764,85.352,0,103.572,0h197.605L441.412,140.235z"/><polygon style="fill:#219B38;" points="320.31,137.188 441.412,187.079 441.412,140.235 372.751,119.962 "/><path style="fill:#6ACE7C;" d="M441.412,140.235H334.16c-18.22,0-32.983-14.764-32.983-32.983V0L441.412,140.235z"/><path style="fill:#FFFFFF;" d="M337.115,254.946H174.876c-5.82,0-10.536,4.717-10.536,10.536v141.169 c0,5.818,4.716,10.536,10.536,10.536h162.239c5.82,0,10.536-4.717,10.536-10.536V265.482 C347.651,259.664,342.935,254.946,337.115,254.946z M185.412,322.682h60.048v26.773h-60.048V322.682z M266.531,322.682h60.048 v26.773h-60.048V322.682z M326.58,301.611h-60.048v-25.593h60.048L326.58,301.611L326.58,301.611z M245.46,276.018v25.592h-60.048 v-25.592H245.46z M185.412,370.526h60.048v25.592h-60.048V370.526z M266.531,396.117v-25.592h60.048v25.592H266.531z"/></symbol>
<symbol id="drive" viewBox="0 0 512 512"><polygon style="fill:#28B446;" points="165.891,334.343 161.611,419.266 82.713,479.21 0,333.399 172.602,32.79 253.414,88.26 256.078,178.175 255.315,178.614 "/><polygon style="fill:#219B38;" points="172.602,32.79 221.718,237.124 256.078,178.175 253.414,59.814 "/><polygon style="fill:#FFD837;" points="339.385,32.79 512,333.399 418.917,380.477 345.204,333.851 345.204,333.399 256.078,178.175 172.602,32.79 "/><polygon style="fill:#518EF8;" points="512,333.399 429.339,478.266 82.713,479.21 165.891,334.343 345.204,333.851 "/><polygon style="fill:#3A5BBC;" points="82.713,479.21 227.749,334.173 165.891,334.343 "/><polygon style="fill:#FBBB00;" points="512,333.399 322.76,294.31 345.204,333.851 "/></symbol>
<symbol id="photos" viewBox="0 0 512 512"><polygon style="fill:#D32E2A;" points="385.829,128 385.829,256 347.429,291.072 307.2,256 272.457,241.371 306.59,165.51 "/><polygon style="fill:#3A5BBC;" points="384,385.219 256,385.219 255.39,383.391 226.133,356.291 255.39,308.041 270.629,271.848 355.962,302.043 "/><polygon style="fill:#FBBB00;" points="256.61,128.61 288.305,164.901 256.61,203.959 241.371,240.152 161.524,200.253 128,126.781 256,126.781 "/><polygon style="fill:#28B446;" points="239.543,270.629 204.495,346.843 126.171,384 126.171,256 163.962,232.558 204.8,256 "/><polygon style="fill:#518EF8;" points="512,256 384,385.219 270.629,271.848 307.2,256 385.829,256 "/><polygon style="fill:#91C646;" points="255.39,383.391 255.39,512 126.171,384 239.543,270.629 255.39,307.2 255.39,308.041 "/><polygon style="fill:#FFD837;" points="241.371,240.152 204.8,256 126.171,256 0,256 128,126.781 "/><polygon style="fill:#F14336;" points="385.829,128 272.457,241.371 256.61,204.8 256.61,203.959 256.61,128.61 256.61,0 "/></symbol>
<symbol id="chrome" width="64" height="64" viewBox="0 0 16.933333 16.933333" version="1.1"><g transform="translate(0 -280.07)"><g transform="matrix(1.1941 0 0 1.1941 21.449 -45.325)"><g transform="matrix(.24253 0 0 .24253 -92.377 154.94)" fill-rule="evenodd"><path d="m317.06 499.65c-2.9744 3.9668-4.7552 8.9642-4.7552 14.326 0 13.159 10.594 23.678 23.753 23.678l8.3134-17.028-15.439-3.1621z" fill="#649af5"/><path d="m337.24 503.21 7.1258 17.339-8.3134 17.102c13.159 0 23.753-10.594 23.753-23.753 0-3.8542-0.9287-7.4763-2.5446-10.689z" fill="#a2c2f8"/><path d="m336.05 490.15c-7.7973 0-14.672 3.7368-18.997 9.5057l11.872 17.81 15.439 3.0878-7.1258-17.339h20.02c-3.901-7.7552-11.903-13.064-21.208-13.064z" fill="#3b6bd4"/></g><path d="m-10.86 276.97c1.478 0 2.6679 1.1899 2.6679 2.6679 0 1.478-1.1899 2.6679-2.6679 2.6679-1.478 0-2.6679-1.1899-2.6679-2.6679 0-1.478 1.1899-2.6679 2.6679-2.6679z" fill="#fff" stroke-width=".24253"/><path d="m-10.86 277.58h3e-6c1.1421 0 2.0615 0.91945 2.0615 2.0616 0 1.1421-0.91945 2.0615-2.0615 2.0615h-3e-6c-1.1421 0-2.0615-0.91945-2.0615-2.0615 0-1.1421 0.91945-2.0616 2.0615-2.0616z" fill="#59f" stroke-width=".24253"/></g></g></symbol>
<symbol id="music" width="64" height="64" version="1.1" viewBox="0 0 16.933333 16.933333"><g transform="translate(0 -280.07)"><circle cx="8.4667" cy="288.53" r="6.8792" fill="#ff8242" style="paint-order:stroke markers fill"/><circle cx="8.4667" cy="288.53" r="3.7042" opacity=".15" style="paint-order:stroke markers fill"/><ellipse cx="8.4667" cy="288.53" rx="2.1167" ry="1.5875" fill="#fff" style="paint-order:stroke markers fill"/><rect x="10.054" y="283.77" width=".52917" height="4.7625" fill="#fff" style="paint-order:stroke markers fill"/><path d="m10.054 283.77 1.8521-0.52917v1.0583l-1.8521 0.52917z" fill="#fff" style="paint-order:stroke markers fill"/></g></symbol>
<symbol id="unarchive" width="24" height="24" viewBox="0 0 24 24"><defs><path id="a" d="M0 0h24v24H0V0z"/></defs><clipPath id="b"><use xlink:href="#a" overflow="visible"/></clipPath><path clip-path="url(#b)" d="M20.55 5.22l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.15.55L3.46 5.22C3.17 5.57 3 6.01 3 6.5V19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.49-.17-.93-.45-1.28zM12 9.5l5.5 5.5H14v2h-4v-2H6.5L12 9.5zM5.12 5l.82-1h12l.93 1H5.12z"/></symbol>
<symbol id="archive" width="24" height="24" viewBox="0 0 24 24"><path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"/><path d="M0 0h24v24H0z" fill="none"/></symbol>
<symbol id="sublime" xmlns="http://www.w3.org/2000/svg" width="448" height="448" viewBox="0 0 448 448"><g fill="none" fill-rule="evenodd"><rect width="448" height="448" fill="#444444" fill-rule="nonzero" rx="28"/><path fill="#F48E00" d="M352,225.117193 C352,221.218498 349.1196,218.970345 345.584887,220.087307 L102.415113,297.221712 C98.873288,298.345788 96,302.422344 96,306.313924 L96,385.148673 C96,389.047368 98.873288,391.302635 102.415113,390.178559 L345.584887,313.051268 C349.1196,311.927192 352,307.850636 352,303.951941 L352,225.117193 L352,225.117193 Z"/><path fill="#FF9800" d="M96,223.042442 C96,226.940903 98.8728889,231.017214 102.414222,232.141222 L345.585778,309.278106 C349.127111,310.402114 352,308.146983 352,304.255636 L352,225.418512 C352,221.527165 349.127111,217.450854 345.585778,216.326845 L102.414222,139.189962 C98.8728889,138.065953 96,140.313971 96,144.212432 L96,223.042442 Z"/><path fill="#FF9800" d="M352,63.3188598 C352,59.4201646 349.1196,57.1648974 345.584887,58.2889738 L102.415113,135.416264 C98.873288,136.540341 96,140.616896 96,144.515591 L96,223.35034 C96,227.249035 98.873288,229.497188 102.415113,228.380226 L345.584887,151.245821 C349.1196,150.121744 352,146.045189 352,142.153608 L352,63.3188598 Z"/></g></symbol>
</svg>
</body>
</html>
